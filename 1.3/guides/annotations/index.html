<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="/morphia/1.3/img/favicon.png">

    <title>Annotations</title>

    <link rel="stylesheet" href="/morphia/1.3/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="/morphia/1.3/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="/morphia/1.3/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="/morphia/1.3/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="/morphia/1.3/lib/highlight/styles/idea.css" />
<link rel="stylesheet" href="/morphia/1.3/lib/bootstrap-toggle/bootstrap-toggle.min.css" type="text/css" />
<link rel="stylesheet" href="/morphia/1.3/css/java.css" type="text/css" />


  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="/morphia/1.3/../">
        <img src="/morphia/1.3/img/logo-mongodb-header.png", alt="MongoDB.org" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <a href="https://university.mongodb.com" data-toggle="tooltip" data-placement="bottom" title="Free Online Classes">MongoDB
              University</a>
  <a href="http://www.mongodb.org/downloads" data-toggle="tooltip" data-placement="bottom" title="Download MongoDB">Downloads</a>
  <a href="http://www.mongodb.org/get-involved" data-toggle="tooltip" data-placement="bottom" title="Get involved with MongoDB">Community</a>
  <a href="http://docs.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Documentation">Docs</a>
  <a href="http://blog.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Blog">Blog</a>
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search docs">
    <input type="hidden" name="site" value="/morphia/1.3">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="/morphia/1.3/../">Morphia</a>
          <a class="version pull-right" href="/morphia/1.3">1.3-SNAPSHOT</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
      
    
  
  


        
      
    
      
      
        
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          

          

          
            
            
















<li class="toctree-l1 ">
  <a href="/morphia/1.3/getting-started/" class="">
      <i class='fa fa-road'></i>
      <span>Getting Started</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/getting-started/installation-guide/">
        <i class='fa'></i>
        Installation Guide
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/getting-started/quick-tour/">
        <i class='fa'></i>
        Quick Tour
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            













  




<li class="toctree-l1  current">
  <a href="/morphia/1.3/guides/" class="">
      <i class='fa fa-book'></i>
      <span>Reference Guides</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/aggregation/">
        <i class='fa fa-file-text-o'></i>
        Aggregation
    </a>
  </li>


        
        
        
        
        













  




    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/annotations/">
        <i class='fa fa-file-text-o'></i>
        Annotations
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/indexing/">
        <i class='fa fa-file-text-o'></i>
        Indexing
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/jrebel/">
        <i class='fa fa-file-text-o'></i>
        JRebel
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/lifeCycleMethods/">
        <i class='fa fa-file-text-o'></i>
        Life Cycle Methods
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/querying/">
        <i class='fa fa-file-text-o'></i>
        Querying
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/updating/">
        <i class='fa fa-file-text-o'></i>
        Updating
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/morphia/1.3/guides/validationExtension/">
        <i class='fa fa-file-text-o'></i>
        Validation Extension
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/morphia/1.3/javadoc">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/morphia/1.3/issues-help/">
        <i class='fa fa-life-ring'></i>
        Issues &amp; Help
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/morphia">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
        </ul>
        
    </div>
  </div>
  
</aside>

<div class="option-popup closed hidden" id="optionsVersionsPopup">
<div class="option-header">
  <i class="fa fa-gear"></i>
  <span>OPTIONS</span>
  <i class="fa fa-angle-up pull-right"></i>
</div>
<div class="option-body">
  <ul>
      
      <li>
        <label>Version</label>
        <div class="btn-group btn-group-xs pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Select Version <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" id="optionsVersionsMenu">
          </ul>
        </div>
      </li>

   


    

  </ul>
</div>
</div>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/morphia/blob/master/docs/reference/content/guides/annotations.md" target="_blank" title="Edit guides/annotations.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  
  <li><a href="/morphia/1.3/guides/">Reference Guides</a> <i class="fa fa-angle-right"></i></li>
  <li>Annotations</li>
</ul>
</div>




<h1 id="annotations">Annotations</h1>

<p>Below is a list of all the annotations and a brief description of how to use them.</p>

<h2 id="indexes">Indexes</h2>

<p>Indexes can be defined on each field directly for single field indexing or at the class level for compund indexes.  To see the next few
annotations in context, please refer to <a href="https://github.com/mongodb/morphia/blob/master/morphia/src/test/java/org/mongodb/morphia/TestIndexCollections.java
">TestIndexCollections.java</a> or <a href="https://github.com/mongodb/morphia/blob/master/morphia/src/test/java/org/mongodb/morphia/indexes/TestIndexed.java
">TestIndexed.java</a> in the Morphia source.</p>

<h3 id="index">Index</h3>

<p>The <code>@Index</code> documentation can be found <a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Index.html
">here</a>.  There are two pieces to this
annotation that are mutually exclusive.  The first group of parameters are considered legacy.  They are safe to use but will be removed
in the 2.x series.  These options and more have been conglomerated in the <a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/IndexOptions.html
"><code>@IndexOptions</code></a> annotation.</p>

<h4 id="field">Field</h4>

<p>The <a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Field.html
"><code>@Field</code></a> annotation defines indexing on a specific document field.  Multiple
instances of this annotation may be passed to the <code>@Index</code> annotation to define a compound index on multiple fields.</p>

<h4 id="indexoptions">IndexOptions</h4>

<p>The <a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/IndexOptions.html
"><code>@IndexOptions</code></a> annotation defines the options to apply to an index
definition.  This annotation replaces the fields found directly on the <code>@Index</code> annotation.  This annotation was added to ensure that index
options are consistent across the various index definition approaches.</p>

<h4 id="indexed">Indexed</h4>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Indexed.html
"><code>@Indexed</code></a>, applied to a Java field, marks the field to be indexed by MongoDB.
  This is used for simple, single-field indexes.  As stated above, the <code>options</code> value replaces the individual setting values on the
   <code>@Indexed</code> annotation itself.</p>

<h2 id="entity-mapping">Entity Mapping</h2>

<p>Morphia provides a number of annotations providing for the customization of object mapping.</p>

<h3 id="entity">Entity</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Entity.html
"><code>@Entity</code></a> marks entities to be stored directly in a collection. This annotation
is optional in most cases but is required if an entity is to be mapped to a specifically named collection.  If no mapping is given, the
collection is named after the class itself.  There are two different mechanisms for mapping cross-object relationships in Morphia:
references and embedding.</p>

<h3 id="reference">Reference</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Reference.html
"><code>@Reference</code></a> marks a field as a reference to a document stored in another
collection and is linked (by a <code>DBRef</code> field). When the Entity is loaded, the referenced entity is also be loaded.  Any object referenced
via an <code>@Reference</code> field must have already have a non-null <code>@Id</code> value in the referenced entity. This can be done by either saving the
referenced entities first or by manually assigning them ID values.  By default, these referenced entities are automatically loaded by
Morphia along with the referencing entity.  This can result in a high number of database round trips just to load a single entity.  To
resolve this, <code>lazy = true</code> can be passed to the annotation.  This will create a dynamic proxy which will lazily load the entity the first
time it is referenced in code.</p>

<p>Fields annotated with <code>@Reference</code> will show up in MongoDB as <code>DBRef</code> fields by default.  A <code>DBRef</code> stores not only the entity&rsquo;s ID value
but also the collection name.  In most cases, this is probably redundant information as the collection name is already encoded in the
entity&rsquo;s mapping information.  To reduce the amount of storage necessary to track these references, use <code>idOnly = true</code> in the mapping.
This will result in only the ID value being stored in the document.</p>

<h3 id="embedded">Embedded</h3>

<p>In contrast to <code>@Reference</code> where a nested Java reference ends up as a separate document in a collection,
<a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Embedded.html
"><code>@Embedded</code></a> tells Morphia to embed the document created from the Java object
in the document of the parent object.  This annotation can be applied to the class of the embedded type or on the field holding the
embedded instance.</p>

<h3 id="id">Id</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Id.html
"><code>@Id</code></a> marks a field in an entity to be the <code>_id</code> field in MongoDB.  This
annotation is required on all top level entities regardless of the presence of an <code>@Entity</code> annotation.  If a class is marked with
<code>@Embedded</code> this annotation is not required since embedded documents are not required to have _id fields.</p>

<h3 id="property">Property</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Property.html
"><code>@Property</code></a> is an optional annotation instructing Morphia to persist the
field using the given name in the document saved in MongoDB.  By default, the field name is used as the property name.  This can be
overridden by passing a String with the new name to the annotation.</p>

<h3 id="transient">Transient</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Transient.html
"><code>@Transient</code></a> instructs Morphia to ignore this field when converting an
entity to a document.  The Java keyword <code>transient</code> can also be used instead.</p>

<h3 id="serialized">Serialized</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Serialized.html
"><code>@Serialized</code></a> instructs Morphia to serialize this field using JDK
serialization.  The field&rsquo;s value gets converted to a <code>byte[]</code> and passed to MongoDB.</p>

<h3 id="notsaved">NotSaved</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/NotSaved.html
"><code>@NotSaved</code></a> instructs Morphia to ignore this field when saving but will
 still be loaded from the database when the entity is read.</p>

<h3 id="alsoload">AlsoLoad</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/AlsoLoad.html
"><code>@AlsoLoad</code></a> instructs Morphia to look for a field under different names than
the mapped name.  When a field gets remapped to a new name, you can either update the database and migrate all the fields at once or use
this annotation to tell Morphia what older names to try if the current one fails.  It is an error to have values under both the old and
new key names when loading a document.  These alternate names are not used in queries, however, so if there are queries against this field
they should be updated to use the alternate names as well or the database should be updated such that every instance of the old name is
renamed.</p>

<h3 id="version">Version</h3>

<p><a href="/morphia/1.31.3/javadoc?org/mongodb/morphia/annotations/Version.html
"><code>@Version</code></a> marks a field in an entity to control optimistic locking. If the
versions change in the database while modifying an entity (including deletes) a <code>ConcurrentModificationException</code> will be thrown. This
field will be automatically managed for you &ndash; there is no need to set a value and you should not do so.  If another name beside the Java
field name is desired, a name can be passed to this annotation to change the document&rsquo;s field name.</p>

<h2 id="lifecycle-annotations">Lifecycle Annotations</h2>

<p>There are various annotations which can be used to register callbacks on certain lifecycle events. These include Pre/Post-Persist, Pre-Save, and Pre/Post-Load.</p>

<ul>
<li><code>@PreLoad</code> - Called before mapping the datastore object to the entity (POJO); the DBObject is passed as an argument (you can add/remove/change values)</li>
<li><code>@PostLoad</code> - Called after mapping to the entity</li>
<li><code>@PrePersist</code> - Called before save, it can return a DBObject in place of an empty one.</li>
<li><code>@PreSave</code> - Called before the save call to the datastore</li>
<li><code>@PostPersist</code> - Called after the save call to the datastore</li>
</ul>

<h3 id="examples">Examples</h3>

<p><a href="https://github.com/mongodb/morphia/blob/master/morphia/src/test/java/org/mongodb/morphia/TestQuery.java#L63">This</a> is one of the test
classes.</p>

<p>All parameters and return values are optional in your implemented methods.</p>

<h4 id="prepersist"><code>@PrePersist</code></h4>

<p>Here is a simple example of an entity that always saves the Date it was last updated at.</p>

<pre><code class="language-java">class BankAccount {
  @Id String id;
  Date lastUpdated = new Date();

  @PrePersist void prePersist() {lastUpdated = new Date();}
}
</code></pre>

<h4 id="entitylisteners"><code>@EntityListeners</code></h4>

<p>In addition, you can separate the lifecycle event implementation in an external class, or many.</p>

<pre><code class="language-java">@EntityListeners(BackAccountWatcher.class)
public class BankAccount {
  @Id String id;
  Date lastUpdated = new Date();
}

class BankAccountWatcher{

  @PrePersist void prePersist(BankAccount act) {act.lastUpdated = new Date();}

}
</code></pre>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/morphia/1.3/guides/aggregation/">
      <i class="fa fa-long-arrow-left"> </i> Aggregation
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/morphia/1.3/guides/indexing/">
    Indexing <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li><a href="#annotations">Annotations</a>
<ul>
<li><a href="#indexes">Indexes</a>
<ul>
<li><a href="#index">Index</a>
<ul>
<li><a href="#field">Field</a></li>
<li><a href="#indexoptions">IndexOptions</a></li>
<li><a href="#indexed">Indexed</a></li>
</ul></li>
</ul></li>
<li><a href="#entity-mapping">Entity Mapping</a>
<ul>
<li><a href="#entity">Entity</a></li>
<li><a href="#reference">Reference</a></li>
<li><a href="#embedded">Embedded</a></li>
<li><a href="#id">Id</a></li>
<li><a href="#property">Property</a></li>
<li><a href="#transient">Transient</a></li>
<li><a href="#serialized">Serialized</a></li>
<li><a href="#notsaved">NotSaved</a></li>
<li><a href="#alsoload">AlsoLoad</a></li>
<li><a href="#version">Version</a></li>
</ul></li>
<li><a href="#lifecycle-annotations">Lifecycle Annotations</a>
<ul>
<li><a href="#examples">Examples</a>
<ul>
<li><a href="#prepersist"><code>@PrePersist</code></a></li>
<li><a href="#entitylisteners"><code>@EntityListeners</code></a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "/morphia/1.3",
   VERSION:     "1.3-SNAPSHOT",
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="/morphia/1.3/js/jquery.js"></script>
<script type="text/javascript" src="/morphia/1.3/lib/bootstrap.js"></script>
<script type="text/javascript" src="/morphia/1.3/js/navbar.js"></script>
<script type="text/javascript" src="/morphia/1.3/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="/morphia/1.3/js/scripts.js"></script>
<script type="text/javascript" src="/morphia/1.3/lib/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script type="text/javascript" src="/morphia/1.3/js/java.js"></script>



<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-K75Z5Q"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
{'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K75Z5Q');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>

</body>
</html>

